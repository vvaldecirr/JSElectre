<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="author" content="Valdecir S. Pereira">
<title>JSElectre 1.0</title>
<link rel="stylesheet" href="view/css/style.css" type="text/css" media="screen" />
<!-- <script type="text/javascript" src="model/Matrix.js"></script> -->
<!-- <script type="text/javascript" src="control/Controlador.js"></script> -->
</head>
<body>

<!-- 
-->
<table border="0" width="100%" id="header" cellspacing="0">
	<tr>
		<td width="100"><img alt="IME" src="view/img/ime.png" width="100" height="120"></td>
		<td align="center">
			<h2>JSElectre 1.0</h2>
			<h3>Instituto Militar de Engenharia</h3>
			<h4>Mestrado em Sistemas de Informação</h4>
			<h5>Desenvolvimento de Plataformas Conputacionais de Apoio a Tomada de Decisão</h5>
			<h5>Professor: Marcos Santos / Aluno: <a href="mailto:vvaldecirr@hotmail.com">Valdecir S. Pereira</a></h5>
		</td>
		<td width="100"><img alt="IME" src="view/img/language.png" width="100" height="120"></td>
	</tr>
</table>

<fieldset>
    <legend>size of matrix:</legend>
	<form id="dimentions" action="index.html">
		<table border="0" width="100">
			<tr><td><img src="view/img/arrows.png" width="50" height="50" /></td><td align="right" valign="top">
				criteries:<br />
				<input class='inputmtx' id="cols" type="number" max="26" min="1" placeholder="nº">
			</td></tr>
			<tr><td>
				elements:<br />
				<input class='inputmtx' id="rows" type="number" max="26" min="1" placeholder="nº"><br />
			</td><td align="right" valign="bottom"><input type="submit" value="   new   "></td></tr>
		</table>
	</form>
</fieldset>

<fieldset>
    <legend>performance matrix:</legend>
		<form id="matrix" action="index.html">
			<div id="matrix-input"></div>
		</form>
</fieldset>

<div id="table"></div>

<script type="text/javascript" src="view/jquery-1.7.1.min.js"></script>
<script>
	var text, rows, cols, pmatrix, cmatrix, dmatrix, concordance, discordance, i, j, k, l, weight;
	var elementnames	= ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "W", "U", "V", "X", "Y", "Z", ];
	var criterianames	= ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "W", "U", "V", "X", "Y", "Z", ];

	// script that get the size of matrix entry and generate the performance matrix
	$( "#dimentions" ).submit(function( event ) {

		rows = $("#rows").val();
		cols = $("#cols").val();

		$("#matrix-input").html("");
		
		$("#matrix-input").append("<input class='inputmtx' id='concordance' type='number' step='0.01' max='1' min='0' value='1'> ^c<br /><input class='inputmtx' id='discordance' type='number' step='0.01' max='1' min='0' value='0'> ^d<br /><br />");

		// fill array pmvalues[i][j] named "pmvaluesl_c_"
		text = "<table border='0'>";

		for (i=0; i<rows; i++) {
			text += "<tr>";

			if (i==0) // verifying if it's the first cell of table for keep it empty 
				text += "<td></td>";

			if (i==0) { // filling with titles
				for (k=0; k<cols; k++)
					text += "<td align='center'>"+criterianames[k]+"</td>";
			} else {
				for (j=0; j<cols; j++) {
					if (j==0) {
						text += "<td align='center'>"+elementnames[i-1]+"</td><td><input class='inputmtx' id='pmvaluesl"+(i-1)+"c"+j+"' type='number' value='0'></td>";
					} else
						text += "<td><input class='inputmtx' id='pmvaluesl"+(i-1)+"c"+j+"' type='number' value='0'></td>";
				}
			}

			text += "</tr>";

		}

		for (l=0; l<cols; l++) {
			if (l==0) {
				text += "<td align='center'>"+elementnames[i-1]+"</td><td><input class='inputmtx' id='pmvaluesl"+(i-1)+"c"+l+"' type='number' value='0'></td>";
			} else
				text += "<td><input class='inputmtx' id='pmvaluesl"+(i-1)+"c"+l+"' type='number' value='0'></td>";
		} 

		//last line
		text += "<tr>";
		for (l=0; l<cols; l++) {
			if (l==0) {
				text += "<td align='center' height='40'>weight: </td><td><input class='inputmtx' id='pmvaluesl"+i+"c"+l+"' type='number' value='0'></td>";
			} else
				text += "<td height='40'><input class='inputmtx' id='pmvaluesl"+i+"c"+l+"' type='number' value='0'></td>";
		} 
		text += "</tr>";

		text += "</table>";

		$("#matrix-input").append(text);

		$("#matrix-input").append("<input id='pmatrixbtn' type='submit' value='calculate'>");
		
		event.preventDefault();
	});

	// script that get the values of performance matrix and full fill the other matrix already souwing the results	
	$( "#matrix" ).submit(function( event ) {
		var max		= [];		
		var min		= [];
		var maux, minx, maxdelta;
		
		// getting overclassification indexes
		concordance = ($("#concordance").val());
		discordance = ($("#discordance").val());

		// criating a multidimentional performance array as pmatrix with form values
		pmatrix = [];
		for (i=0; i<rows; i++) {
			pmatrix[i] = new Array(); // elements
			
			for (j=0; j<cols; j++) 
				pmatrix[i][j] = ($("#pmvaluesl"+i+"c"+j).val()*1); // criteries
		}
		console.log(pmatrix);
		
		// filling the weight array
		weight	= [];
		for (k=0; k<cols; k++) {
			//console.log($("#pmvaluesl"+rows+"c"+k).val()*1);
			weight[k] = $("#pmvaluesl"+rows+"c"+k).val()*1;
		}
		console.log("weight: "+weight);
		
		// calculate the max
		for (k=0; k<cols; k++) {
			for (l=0; l<rows; l++) {
				if (l==0)
					maux = pmatrix[l][k];
				else if (maux < pmatrix[l][k])
					maux = pmatrix[l][k];
			}
			max[k] = maux;
		}
		
		// calculate the min
		for (k=0; k<cols; k++) {
			for (l=0; l<rows; l++) {
				if (l==0)
					minx = pmatrix[l][k];
				else if (minx > pmatrix[l][k])
					minx = pmatrix[l][k];
			}
			min[k] = minx;
		}
		
		// calculate the maxdelta
		for (k=0; k<cols; k++) {
			if (k==0)
				maxdelta = max[k]-min[k];
			else if ( maxdelta < (max[k]-min[k]) )
				maxdelta = max[k]-min[k];
		}
		console.log("maxdelta: "+maxdelta);
		
		/*/ calculatind the multidimentional concordance array as cmatrix from pmatrix array
		cmatrix = [];
		for (i=0; i<rows; i++) {
			cmatrix[i] = new Array(); // elements
			
			for (j=0; j<cols; j++) 
				//cmatrix[i][j] = concordCel(i, j);
		}*/
		console.log(pmatrix);
		
		// this function return the value of each concordance cell from performance's matrix ROW and COLUMN information
		function concordCel (var row, var col) {
			if (row==col)
				return "-";
			else {
				pmatrix[row][col]
				return;				
			}
		}
		
		event.preventDefault();
	});
</script>
 
<a href="view/arbor/demos/index.html#/js-electre-1">graph</a> 

</body>
</html>
